<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>记账</title>
</head>
<body>
	<div>
		<h2>我的账单</h2>
	</div>
	<hr>
	<div class="container">
		<div>
			<span>每月工资：</span>
			<input id="sal" type="text" name=""/>
			<span>元</span>
		</div>
		<hr>
		<div>
			<span>当月支出如下</span>
		</div>
		<div>
			<span>我的伙食费：</span>
			<input id="my_board_wag" type="text" name=""/>
			<span>元</span>
		</div>
		<div>
			<span>我的社交花费：</span>
			<input id="si_exp" type="text" name=""/>
			<span>元</span>
		</div>
		<div>
			<span>我的话费：</span>
			<input id="my_tel_exp" type="text" name=""/>
			<span>元</span>
		</div>
		<div>
			<span>我的还款：</span>
			<input id="repay" type="text" name=""/>
			<span>元</span>
		</div>
		<div>
			<span>爸妈的伙食费：</span>
			<input id="pre_board_wag" type="text" name=""/>
			<span>元</span>
		</div>
		<div>
			<span>弟妹的伙食费：</span>
			<input id="bs_board_wag" type="text" name=""/>
			<span>元</span>
		</div>
		<div>
			<span>爸妈的话费：</span>
			<input id="pre_tel_exp" type="text" name=""/>
			<span>元</span>
		</div>
		<div>
			<span>弟妹的话费：</span>
			<input id="bs_tel_exp" type="text" name=""/>
			<span>元</span>
			<input id="allClear" value="全部清空" type="button" name=""/>
		</div>
		<hr>
		<div>
			<span id="total">总共：</span>
			<span>元</span>
		</div>
		<div>
			<span id="sur">剩余：</span>
			<span>元</span>
		</div>
		<hr>
		<div>
			<textarea id='saveTxt' cols="60" rows="15" readonly="true"></textarea>
			<input id="copy" type="button" value="全选复制到剪贴板" name=""/>
		</div>
	</div>
</body>
<script type="text/javascript">

	/*兼容性事件绑定*/
	function myAddEvent(obj,sEvent,fn){//对象，事件名的字符串，方法
    	if(obj.attachEvent){//ie方式
        	obj.attachEvent('on'+sEvent,fn);//在ie下绑定事件中的事件名前on开头
    	}else{//DOM方式
        	obj.addEventListener(sEvent,fn,false);//不采用捕获方式，采用冒泡的方式
    	}
	}

	/*兼容性解除事件绑定*/
	function myReduce(obj,sEvent,fn){
		if(obj.detachEvent){
			obj.detachEvent('on'+sEvent,fn);
		}else{
			obj.removeEventListener(sEvent,fn,false);
		}
	}

	function test(){alert('hihi');}

	/* 获取当前的日期时间 格式“yyyy-MM-dd HH:MM:SS” */
	function getNowFormatDate() {
    	var date = new Date();
    	var seperator1 = "-";
    	var seperator2 = ":";
    	var month = date.getMonth() + 1;
    	var strDate = date.getDate();
    	if (month >= 1 && month <= 9) {
        	month = "0" + month;
    	}
    	if (strDate >= 0 && strDate <= 9) {
        	strDate = "0" + strDate;
    	}
    	var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes()
            + seperator2 + date.getSeconds();

    	return currentdate;
	}
</script>
<script type="text/javascript">
	;(function(){
		'use strict';

		var oSal = document.getElementById('sal'),
			oMy_board_wag = document.getElementById('my_board_wag'),
			oSi_exp = document.getElementById('si_exp'),
			oMy_tel_exp = document.getElementById('my_tel_exp'),
			oRepay = document.getElementById('repay'),
			oPre_board_wag = document.getElementById('pre_board_wag'),
			oBs_board_wag = document.getElementById('bs_board_wag'),
			oPre_tel_exp = document.getElementById('pre_tel_exp'),
			oBs_tel_exp = document.getElementById('bs_tel_exp'),
			oTotal = document.getElementById('total'),
			oSur = document.getElementById('sur'),
			oSaveTxt = document.getElementById('saveTxt'),
			oCopy = document.getElementById('copy'),
			oAllClear = document.getElementById('allClear');

		var sal, my_board_wag, si_exp, my_tel_exp, repay, pre_board_wag, bs_board_wag, pre_tel_exp, bs_tel_exp,total;

		var timer1 = null;
		
		oTotal.innerHTML = '总共：' + 0;
		oSur.innerHTML = '剩余：' + 0;

		function initValue() {
			oSal.value = oMy_board_wag.value = oSi_exp.value = oMy_tel_exp.value = oRepay.value = oPre_board_wag.value = oBs_board_wag.value = oPre_tel_exp.value = oBs_tel_exp.value = 0;
		}
		initValue();

		function doMain(){
			clearInterval(timer1);

			timer1 = setInterval(function(){
			sal = parseFloat(oSal.value);
			my_board_wag = parseFloat(oMy_board_wag.value);
			si_exp = parseFloat(oSi_exp.value);
			my_tel_exp = parseFloat(oMy_tel_exp.value);
			repay = parseFloat(oRepay.value);
			pre_board_wag = parseFloat(oPre_board_wag.value);
			bs_board_wag = parseFloat(oBs_board_wag.value);
			pre_tel_exp = parseFloat(oPre_tel_exp.value);
			bs_tel_exp = parseFloat(oBs_tel_exp.value);

			if(isNaN(sal) && oSal.value != '') {
				alert('你输入的不是数字，请重新输入');
				oSal.value = 0;
			}
			if(isNaN(my_board_wag) && oMy_board_wag.value != '') {
				alert('你输入的不是数字，请重新输入');
				oMy_board_wag.value = 0;
			}
			if(isNaN(si_exp) && oSi_exp.value != '') {
				alert('你输入的不是数字，请重新输入');
				oSi_exp.value = 0;
			}
			if(isNaN(my_tel_exp) && oMy_tel_exp.value != '') {
				alert('你输入的不是数字，请重新输入');
				oMy_tel_exp.value = 0;
			}
			if(isNaN(repay) && oRepay.value != '') {
				alert('你输入的不是数字，请重新输入');
				oRepay.value = 0;
			}
			if(isNaN(pre_board_wag) && oPre_board_wag.value != '') {
				alert('你输入的不是数字，请重新输入');
				oPre_board_wag.value = 0;
			}
			if(isNaN(bs_board_wag) && oBs_board_wag.value != '') {
				alert('你输入的不是数字，请重新输入');
				oBs_board_wag.value = 0;
			}
			if(isNaN(pre_tel_exp) && oPre_tel_exp.value != '') {
				alert('你输入的不是数字，请重新输入');
				oPre_tel_exp.value = 0;
			}
			if(isNaN(bs_tel_exp) && oBs_tel_exp.value != '') {
				alert('你输入的不是数字，请重新输入');
				oBs_tel_exp.value = 0;
			}

			total = my_board_wag + si_exp + my_tel_exp + repay + pre_board_wag + bs_board_wag + pre_tel_exp + bs_tel_exp;

			oTotal.innerHTML = '总共：' + total;
			oSur.innerHTML = '剩余：' + (sal - total);

			oSaveTxt.innerHTML = '每月工资：' + oSal.value + '元' + '\r\n'
								+ '--------------------------------------------------------------' + '\r\n'
								+ '我的伙食费：' + oMy_board_wag.value + '元' + '\r\n'
								+ '我的社交花费：' + oSi_exp.value + '元' + '\r\n'
								+ '我的话费：' + oMy_tel_exp.value + '元' + '\r\n'
								+ '我的还款：' + oRepay.value + '元' + '\r\n'
								+ '爸妈的伙食费：' + oPre_board_wag.value + '元' + '\r\n'
								+ '弟妹的伙食费：' + oBs_board_wag.value + '元' + '\r\n'
								+ '爸妈的话费：' + oPre_tel_exp.value + '元' + '\r\n'
								+ '弟妹的话费：' + oBs_tel_exp.value + '元' + '\r\n'
								+ '--------------------------------------------------------------' + '\r\n'
								+ '总共：' + total + '元' + '\r\n'
								+ '剩余：' + (sal - total) + '元' + '\r\n'
								+ '日期时间：' + getNowFormatDate() + '\r\n'
								+ '==============================================================' + '\r\n';
			},250);
		}
		doMain();

		function clear(){
			this.value = '';
		}
		function addZero(){
			if(this.value == ''){
				this.value = 0;
			}
		}
		function copy() {
			oSaveTxt.select();
			document.execCommand("Copy"); // 执行浏览器复制命令
			alert('已经全选复制到剪贴板了');
		}

		window.onload = function(){
			myAddEvent(oSal, 'blur', addZero);
			myAddEvent(oSal, 'click', clear);
			myAddEvent(oMy_board_wag, 'blur', addZero);
			myAddEvent(oMy_board_wag, 'click', clear);
			myAddEvent(oSi_exp, 'blur', addZero);
			myAddEvent(oSi_exp, 'click', clear);
			myAddEvent(oMy_tel_exp, 'blur', addZero);
			myAddEvent(oMy_tel_exp, 'click', clear);
			myAddEvent(oRepay, 'blur', addZero);
			myAddEvent(oRepay, 'click', clear);
			myAddEvent(oPre_board_wag, 'blur', addZero);
			myAddEvent(oPre_board_wag, 'click', clear);
			myAddEvent(oBs_board_wag, 'blur', addZero);
			myAddEvent(oBs_board_wag, 'click', clear);
			myAddEvent(oPre_tel_exp, 'blur', addZero);
			myAddEvent(oPre_tel_exp, 'click', clear);
			myAddEvent(oBs_tel_exp, 'blur', addZero);
			myAddEvent(oBs_tel_exp, 'click', clear);

			myAddEvent(oCopy, 'click', copy);

			myAddEvent(oAllClear, 'click', initValue);	
		};
	})();
</script>
</html>